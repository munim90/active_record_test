From 1079900a97cce2b0d41ddfefe015cde461ecd29e Mon Sep 17 00:00:00 2001
From: Noel Rappin <noelrap@hey.com>
Date: Thu, 17 Jun 2021 21:26:12 -0500
Subject: [PATCH] Fix

---
 .tool-versions                               |   1 +
 spec/controllers/projects_controller_spec.rb |   4 +
 spec/examples.txt                            | 132 +++++++++----------
 spec/factories/users.rb                      |   3 +-
 spec/requests/tasks_request_spec.rb          |   2 +
 spec/system/add_project_spec.rb              |   2 +-
 spec/system/add_task_spec.rb                 |   4 +
 7 files changed, 80 insertions(+), 68 deletions(-)
 create mode 100644 .tool-versions

diff --git a/.tool-versions b/.tool-versions
new file mode 100644
index 0000000..9eb38ed
--- /dev/null
+++ b/.tool-versions
@@ -0,0 +1 @@
+ruby 2.7.2
diff --git a/spec/controllers/projects_controller_spec.rb b/spec/controllers/projects_controller_spec.rb
index 2b39a57..9916863 100644
--- a/spec/controllers/projects_controller_spec.rb
+++ b/spec/controllers/projects_controller_spec.rb
@@ -2,6 +2,10 @@ require "rails_helper"
 
 RSpec.describe ProjectsController, type: :controller do
 
+  before(:example) do
+    sign_in(create(:user))
+  end
+
   describe "create" do
     it "calls the workflow with parameters" do
       workflow = instance_spy(CreatesProject, success?: true)
diff --git a/spec/examples.txt b/spec/examples.txt
index 930f39b..2331742 100644
--- a/spec/examples.txt
+++ b/spec/examples.txt
@@ -1,69 +1,69 @@
 example_id                                            | status  | run_time        |
 ----------------------------------------------------- | ------- | --------------- |
-./spec/controllers/projects_controller_spec.rb[1:1:1] | failed  | 0.08149 seconds |
-./spec/helpers/projects_helper_spec.rb[1:1]           | passed  | 0.02193 seconds |
-./spec/helpers/projects_helper_spec.rb[1:2]           | passed  | 0.00476 seconds |
-./spec/models/project_spec.rb[1:1:1]                  | passed  | 0.005 seconds   |
-./spec/models/project_spec.rb[1:1:2]                  | passed  | 0.00266 seconds |
-./spec/models/project_spec.rb[1:2:1:1]                | passed  | 0.01407 seconds |
-./spec/models/project_spec.rb[1:2:1:2]                | passed  | 0.00574 seconds |
-./spec/models/project_spec.rb[1:2:2:1]                | passed  | 0.02675 seconds |
-./spec/models/project_spec.rb[1:2:2:2]                | passed  | 0.01684 seconds |
-./spec/models/project_spec.rb[1:3:1]                  | passed  | 0.00403 seconds |
-./spec/models/project_spec.rb[1:3:2]                  | passed  | 0.0039 seconds  |
-./spec/models/project_spec.rb[1:3:3]                  | passed  | 0.00366 seconds |
-./spec/models/project_spec.rb[1:3:4]                  | passed  | 0.00322 seconds |
-./spec/models/project_spec.rb[1:3:5]                  | passed  | 0.00362 seconds |
-./spec/models/project_spec.rb[1:3:6]                  | passed  | 0.00387 seconds |
-./spec/models/project_spec.rb[1:3:7]                  | passed  | 0.00411 seconds |
-./spec/models/project_spec.rb[1:4:1]                  | passed  | 0.00532 seconds |
-./spec/models/project_spec.rb[1:4:2]                  | passed  | 0.00625 seconds |
-./spec/models/project_spec.rb[1:5:1]                  | passed  | 0.00122 seconds |
-./spec/models/project_spec.rb[1:5:2]                  | passed  | 0.00128 seconds |
-./spec/models/project_spec.rb[1:5:3]                  | passed  | 0.00083 seconds |
-./spec/models/project_spec.rb[1:5:4]                  | passed  | 0.00071 seconds |
-./spec/models/task_spec.rb[1:1:1]                     | passed  | 0.00091 seconds |
-./spec/models/task_spec.rb[1:1:2]                     | passed  | 0.00064 seconds |
-./spec/models/task_spec.rb[1:2:1]                     | passed  | 0.0005 seconds  |
-./spec/models/task_spec.rb[1:2:2]                     | passed  | 0.0005 seconds  |
-./spec/models/task_spec.rb[1:2:3]                     | passed  | 0.00066 seconds |
-./spec/models/task_spec.rb[1:3:1]                     | passed  | 0.00054 seconds |
-./spec/models/task_spec.rb[1:3:2]                     | passed  | 0.00069 seconds |
-./spec/models/task_spec.rb[1:3:3]                     | passed  | 0.00061 seconds |
-./spec/models/task_spec.rb[1:4:1]                     | passed  | 0.01004 seconds |
-./spec/models/task_spec.rb[1:4:2]                     | passed  | 0.00751 seconds |
-./spec/models/task_spec.rb[1:4:3]                     | passed  | 0.00881 seconds |
-./spec/models/task_spec.rb[1:4:4]                     | passed  | 0.00876 seconds |
-./spec/models/task_spec.rb[1:4:5]                     | passed  | 0.00625 seconds |
-./spec/models/task_spec.rb[1:4:6]                     | passed  | 0.00639 seconds |
+./spec/controllers/projects_controller_spec.rb[1:1:1] | passed  | 0.03322 seconds |
+./spec/helpers/projects_helper_spec.rb[1:1]           | passed  | 0.0075 seconds  |
+./spec/helpers/projects_helper_spec.rb[1:2]           | passed  | 0.00145 seconds |
+./spec/models/project_spec.rb[1:1:1]                  | passed  | 0.00707 seconds |
+./spec/models/project_spec.rb[1:1:2]                  | passed  | 0.00028 seconds |
+./spec/models/project_spec.rb[1:2:1:1]                | passed  | 0.00329 seconds |
+./spec/models/project_spec.rb[1:2:1:2]                | passed  | 0.00085 seconds |
+./spec/models/project_spec.rb[1:2:2:1]                | passed  | 0.0042 seconds  |
+./spec/models/project_spec.rb[1:2:2:2]                | passed  | 0.00062 seconds |
+./spec/models/project_spec.rb[1:3:1]                  | passed  | 0.0014 seconds  |
+./spec/models/project_spec.rb[1:3:2]                  | passed  | 0.00116 seconds |
+./spec/models/project_spec.rb[1:3:3]                  | passed  | 0.00111 seconds |
+./spec/models/project_spec.rb[1:3:4]                  | passed  | 0.00115 seconds |
+./spec/models/project_spec.rb[1:3:5]                  | passed  | 0.00113 seconds |
+./spec/models/project_spec.rb[1:3:6]                  | passed  | 0.00127 seconds |
+./spec/models/project_spec.rb[1:3:7]                  | passed  | 0.00128 seconds |
+./spec/models/project_spec.rb[1:4:1]                  | passed  | 0.00178 seconds |
+./spec/models/project_spec.rb[1:4:2]                  | passed  | 0.00338 seconds |
+./spec/models/project_spec.rb[1:5:1]                  | passed  | 0.00051 seconds |
+./spec/models/project_spec.rb[1:5:2]                  | passed  | 0.00026 seconds |
+./spec/models/project_spec.rb[1:5:3]                  | passed  | 0.00025 seconds |
+./spec/models/project_spec.rb[1:5:4]                  | passed  | 0.00025 seconds |
+./spec/models/task_spec.rb[1:1:1]                     | passed  | 0.00031 seconds |
+./spec/models/task_spec.rb[1:1:2]                     | passed  | 0.00025 seconds |
+./spec/models/task_spec.rb[1:2:1]                     | passed  | 0.00031 seconds |
+./spec/models/task_spec.rb[1:2:2]                     | passed  | 0.00022 seconds |
+./spec/models/task_spec.rb[1:2:3]                     | passed  | 0.00031 seconds |
+./spec/models/task_spec.rb[1:3:1]                     | passed  | 0.0002 seconds  |
+./spec/models/task_spec.rb[1:3:2]                     | passed  | 0.00029 seconds |
+./spec/models/task_spec.rb[1:3:3]                     | passed  | 0.00026 seconds |
+./spec/models/task_spec.rb[1:4:1]                     | passed  | 0.00419 seconds |
+./spec/models/task_spec.rb[1:4:2]                     | passed  | 0.0025 seconds  |
+./spec/models/task_spec.rb[1:4:3]                     | passed  | 0.00312 seconds |
+./spec/models/task_spec.rb[1:4:4]                     | passed  | 0.00364 seconds |
+./spec/models/task_spec.rb[1:4:5]                     | passed  | 0.00221 seconds |
+./spec/models/task_spec.rb[1:4:6]                     | passed  | 0.00203 seconds |
 ./spec/models/user_spec.rb[1:1]                       | pending | 0.00001 seconds |
-./spec/presenters/project_presenter_spec.rb[1:1]      | passed  | 0.00082 seconds |
-./spec/presenters/project_presenter_spec.rb[1:2]      | passed  | 0.00059 seconds |
-./spec/requests/tasks_request_spec.rb[1:1]            | passed  | 0.02227 seconds |
-./spec/requests/tasks_request_spec.rb[1:2]            | failed  | 0.01169 seconds |
-./spec/routing/project_routing_spec.rb[1:1]           | passed  | 0.00248 seconds |
-./spec/system/add_project_spec.rb[1:1]                | failed  | 0.0108 seconds  |
-./spec/system/add_project_spec.rb[1:2]                | failed  | 0.00202 seconds |
-./spec/system/add_project_spec.rb[1:3]                | failed  | 0.00187 seconds |
-./spec/system/add_task_spec.rb[1:1]                   | failed  | 5.44 seconds    |
-./spec/system/user_and_role_spec.rb[1:1]              | passed  | 0.085 seconds   |
-./spec/system/user_and_role_spec.rb[1:2]              | passed  | 0.02672 seconds |
-./spec/views/projects/index.html.erb_spec.rb[1:1]     | passed  | 0.01604 seconds |
-./spec/workflows/creates_project_spec.rb[1:1:1]       | passed  | 0.00091 seconds |
-./spec/workflows/creates_project_spec.rb[1:2:1]       | passed  | 0.00194 seconds |
-./spec/workflows/creates_project_spec.rb[1:3:1]       | passed  | 0.00128 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:1:1]     | passed  | 0.00062 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:2:1]     | passed  | 0.00061 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:2:2]     | passed  | 0.00268 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:3:1]     | passed  | 0.00056 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:3:2]     | passed  | 0.00092 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:4:1]     | passed  | 0.00067 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:4:2]     | passed  | 0.00073 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:5:1]     | passed  | 0.00063 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:5:2]     | passed  | 0.00078 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:6:1]     | passed  | 0.00084 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:6:2]     | passed  | 0.00082 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:7:1]     | passed  | 0.0007 seconds  |
-./spec/workflows/creates_project_spec.rb[1:4:7:2]     | passed  | 0.00163 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:8:1]     | passed  | 0.00377 seconds |
-./spec/workflows/creates_project_spec.rb[1:4:8:2]     | passed  | 0.0034 seconds  |
+./spec/presenters/project_presenter_spec.rb[1:1]      | passed  | 0.00036 seconds |
+./spec/presenters/project_presenter_spec.rb[1:2]      | passed  | 0.00024 seconds |
+./spec/requests/tasks_request_spec.rb[1:1]            | passed  | 0.01241 seconds |
+./spec/requests/tasks_request_spec.rb[1:2]            | passed  | 0.01174 seconds |
+./spec/routing/project_routing_spec.rb[1:1]           | passed  | 0.00098 seconds |
+./spec/system/add_project_spec.rb[1:1]                | passed  | 0.0425 seconds  |
+./spec/system/add_project_spec.rb[1:2]                | passed  | 0.01768 seconds |
+./spec/system/add_project_spec.rb[1:3]                | passed  | 0.01697 seconds |
+./spec/system/add_task_spec.rb[1:1]                   | passed  | 0.02155 seconds |
+./spec/system/user_and_role_spec.rb[1:1]              | passed  | 0.03259 seconds |
+./spec/system/user_and_role_spec.rb[1:2]              | passed  | 0.01383 seconds |
+./spec/views/projects/index.html.erb_spec.rb[1:1]     | passed  | 0.00529 seconds |
+./spec/workflows/creates_project_spec.rb[1:1:1]       | passed  | 0.00033 seconds |
+./spec/workflows/creates_project_spec.rb[1:2:1]       | passed  | 0.00054 seconds |
+./spec/workflows/creates_project_spec.rb[1:3:1]       | passed  | 0.00048 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:1:1]     | passed  | 0.00019 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:2:1]     | passed  | 0.0002 seconds  |
+./spec/workflows/creates_project_spec.rb[1:4:2:2]     | passed  | 0.001 seconds   |
+./spec/workflows/creates_project_spec.rb[1:4:3:1]     | passed  | 0.0002 seconds  |
+./spec/workflows/creates_project_spec.rb[1:4:3:2]     | passed  | 0.00022 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:4:1]     | passed  | 0.00018 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:4:2]     | passed  | 0.00022 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:5:1]     | passed  | 0.00017 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:5:2]     | passed  | 0.00023 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:6:1]     | passed  | 0.00018 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:6:2]     | passed  | 0.00021 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:7:1]     | passed  | 0.0002 seconds  |
+./spec/workflows/creates_project_spec.rb[1:4:7:2]     | passed  | 0.00031 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:8:1]     | passed  | 0.00149 seconds |
+./spec/workflows/creates_project_spec.rb[1:4:8:2]     | passed  | 0.00115 seconds |
diff --git a/spec/factories/users.rb b/spec/factories/users.rb
index 628434c..ecd4b77 100644
--- a/spec/factories/users.rb
+++ b/spec/factories/users.rb
@@ -1,5 +1,6 @@
 FactoryBot.define do
   factory :user do
-    
+    sequence(:email) { |n| "user_#{n}@example.com" }
+    password { "password" }
   end
 end
diff --git a/spec/requests/tasks_request_spec.rb b/spec/requests/tasks_request_spec.rb
index 530e2bf..4dfb886 100644
--- a/spec/requests/tasks_request_spec.rb
+++ b/spec/requests/tasks_request_spec.rb
@@ -3,9 +3,11 @@ require "rails_helper"
 RSpec.describe "task requests" do
 
     before(:example) do
+        sign_in(create(:user))
         ActionMailer::Base.deliveries.clear
     end
 
+
     let(:project) { create(:project, name: "Project Bluebook") }
     let(:task) {  create(:task, project: project, title: "Learn how to test mailers", size: 3) }
 
diff --git a/spec/system/add_project_spec.rb b/spec/system/add_project_spec.rb
index 2976fa2..83ab5ed 100644
--- a/spec/system/add_project_spec.rb
+++ b/spec/system/add_project_spec.rb
@@ -5,7 +5,7 @@ RSpec.describe "adding a project", type: :system do
   before(:example) do
     sign_in(create(:user))
   end
-  
+
   it "allows a user to create a project with tasks" do
     visit new_project_path
     fill_in "Name", with: "Project Runway"
diff --git a/spec/system/add_task_spec.rb b/spec/system/add_task_spec.rb
index a334638..a8ae6fc 100644
--- a/spec/system/add_task_spec.rb
+++ b/spec/system/add_task_spec.rb
@@ -2,6 +2,10 @@
 require "rails_helper"
 
 RSpec.describe "adding a new task" do
+  before(:example) do
+    sign_in(create(:user))
+  end
+
   let!(:project) { create(:project, name: "Project Bluebook") }
   let!(:task_1) { create(
     :task, project: project, title: "Search Sky", size: 1, project_order: 1) }
-- 
2.31.1

